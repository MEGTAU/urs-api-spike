<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Universal Relationship Server Spike</title>
    <style>
        body {
            font-family: sans-serif;
            margin: 2em;
        }

        h1 {
            text-align: center;
        }

        h2 {
            margin-top: 2em;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 1em;
        }

        th, td {
            border: 1px solid #ccc;
            padding: 0.5em;
            text-align: left;
        }

        th {
            background-color: #f4f4f4;
        }

        /* Style the tab */
        .tab {
            overflow: hidden;
            border: 1px solid #ccc;
            background-color: #f1f1f1;
        }

        /* Style the buttons that are used to open the tab content */
        .tab button {
            background-color: inherit;
            float: left;
            border: none;
            outline: none;
            cursor: pointer;
            padding: 14px 16px;
            transition: 0.3s;
        }

        /* Change background color of buttons on hover */
        .tab button:hover {
            background-color: #ddd;
        }

        /* Create an active/current tablink class */
        .tab button.active {
            background-color: #ccc;
        }

        /* Style the tab content */
        .tabcontent {
            display: none;
            padding: 6px 12px;
            border: 1px solid #ccc;
            border-top: none;
        }

        .tabcontent {
            animation: fadeEffect 1s; /* Fading effect takes 1 second */
        }

        /* Go from zero to full opacity */
        @keyframes fadeEffect {
            from {
                opacity: 0;
            }
            to {
                opacity: 1;
            }
        }
    </style>
</head>
<body>
<h1>Universal Relationship Server Spike</h1>

<!-- Tab links -->
<div class="tab">
    <button class="tablinks" onclick="openTab(event, 'About')" id="defaultOpen">About</button>
    <button class="tablinks" onclick="openTab(event, 'Contacts/Persons')">Contacts/Persons</button>
    <button class="tablinks" onclick="openTab(event, 'Organisations')">Organisations</button>
    <button class="tablinks" onclick="openTab(event, 'Relationships')">Relationships</button>
    <button class="tablinks" onclick="openTab(event, 'Interactions')">Interactions</button>
</div>

<!-- Tab content -->
<div id="About" class="tabcontent">
    <h2>About</h2>

    <ul>
        <li>
            <a href="http://localhost:8080/api-docs">API Documentation</a>
        </li>
        <li>
            <a href="http://localhost:8080/swagger-ui">Swagger UI</a>
        </li>
        <li>
            <a href="http://localhost:8080/openapi">Raw Open API specification</a>
        </li>
    </ul>

    <h3>Out of Scope</h3>

    The following items are out of scope for this spike:
    <ul>
        <li>Implementation of authentication and authorisation. It can be deployed and secured using Google IAP or AWS
            Identity Service for internal review and discussion.
        </li>
        <li>CI/CD</li>
        <li>Implement pagination</li>
        <li>Search</li>
    </ul>

    <h3>Todos</h3>
    <ul>
        <li>Implement authentication and authorisation</li>
        <li>Implement pagination. It is only specified in a handful of cases at the moment.</li>
        <li>Implement sorting and filtering</li>
        <li>Implement more relationship types</li>
        <li>Implement more profile types</li>
        <li>Implement more organisation types</li>
        <li>Implement more contact/person fields</li>
        <li>Implement more organisation fields</li>
        <li>Implement more relationship fields</li>
        <li>Add more tests</li>
    </ul>

</div>

<div id="Contacts/Persons" class="tabcontent">
    <h2>Contacts/Persons</h2>
    <div style="max-width: 1500px">
        <p>A <code>Contact/Person</code> resource represents the "digital soul". Each <code>Contact/Person</code> may
            have multiple profiles (e.g. <code>jobseeker</code>) associated with them.</p>
        <p>This table displays a "wide view" that contains both the core PII facet of the person/contact and the various
            profiles associated with the individual. The profile data contains a set of standard attributes that can be
            used for all profile types as well as a <code>profileInformation</code> JSON attribute that is used to store
            information specific to a particular profile type. This approach allows new profile types to be introduced
            without modifying the API or database schema.</p>

        <h3>Batch Upload Scenarios</h3>

        <p>For scenarios such as importing lists of jobseekers from a CSV file or adding students/apprentices from ACP
            training contracts, the API implementation will check if a contact/person already exists based on a unique
            identifier such as email or phone number. If the contact/person
            does not exist, it should be created (minted) and the appropriate added to the contact/person. If the
            contact/person does exist, the existing record should be updated
            by associated a new profile of the correct type or updating an existing profile.</p>
    </div>
    <button onclick="exportContacts()">Export Contact/Person Profiles to CSV</button>
    <table id="contacts-table">
        <thead>
        <tr>
            <th>ID</th>
            <th>First Name</th>
            <th>Last Name</th>
            <th>Email</th>
            <th>Phone</th>
            <th>Created At</th>
            <th>Last Seen At</th>
            <th>USI</th>
            <th>LUI</th>
            <th>TFN</th>
            <th>VSN</th>
            <th>WorkReady Participant Number</th>
            <th>SACE Student Id</th>
            <th>Profile ID</th>
            <th>Profile Type</th>
            <th>Started At</th>
            <th>Completed At</th>
            <th>Is Active</th>
            <th>Profile Information</th>
            <th>Organisations</th>
        </tr>
        </thead>
        <tbody>
        <!-- Contact data will be inserted here -->
        </tbody>
    </table>

    <h2>Analyses</h2>
    <div style="max-width: 1500px">
        <p>Each <code>Contact/Person</code> may have analyses (e.g. vibrancy index assessment) associated with them.
            This table provides a "wide view" demonstrating API usage to display the PII facet of the
            <code>Contact</code>.
            as well as the analyses for the <code>Contact</code>. The analysis data contains a set of standard
            attributes that can be
            used for all analysis types as well as a <code>results</code> JSON attribute that is used to store
            results specific to a particular analysis type. This approach allows new analysis types types to be
            introduced
            without modifying the API or database schema.</p>
    </div>
    <button onclick="exportAnalyses()">Export Analyses to CSV</button>
    <table id="analyses-table">
        <thead>
        <tr>
            <th>Contact ID</th>
            <th>First Name</th>
            <th>Last Name</th>
            <th>Analysis ID</th>
            <th>Type</th>
            <th>Date</th>
            <th>Result</th>
            <th>Notes</th>
        </tr>
        </thead>
        <tbody>
        <!-- Analysis data will be inserted here -->
        </tbody>
    </table>

    <h2>System Links</h2>
    <div style="max-width: 1500px">
        <p>Each <code>Contact/Person</code> may have links to external systems associated with them. Examples of
            external systems include student platforms such as aXcelerate and Canvas.
            This table provides a "wide view" demonstrating API usage to display the PII facet of the
            <code>Contact</code> as well as the system links for the <code>Contact</code>.</p>
    </div>
    <button onclick="exportSystemLinks()">Export System Links to CSV</button>
    <table id="system-links-table">
        <thead>
        <tr>
            <th>Contact ID</th>
            <th>First Name</th>
            <th>Last Name</th>
            <th>System Link ID</th>
            <th>System Name</th>
            <th>System ID</th>
            <th>URL</th>
        </tr>
        </thead>
        <tbody>
        <!-- System Link data will be inserted here -->
        </tbody>
    </table>
</div>

<div id="Organisations" class="tabcontent">
    <h2>Organisations</h2>
    <p>This tab displays organisations, such as education providers and employers.</p>
    <button onclick="document.getElementById('import-organisations-input').click()">Import from CSV</button>
    <input type="file" id="import-organisations-input" onchange="importOrganisations(this.files[0])"
           style="display: none;" accept=".csv">
    <button onclick="exportOrganisations()">Export to CSV</button>
    <table id="organisations-table">
        <thead>
        <tr>
            <th>ID</th>
            <th>Legal Name</th>
            <th>Trading Name</th>
            <th>Type</th>
            <th>ABN</th>
            <th>Employer ID</th>
            <th>Worksite Address</th>
            <th>Worksite State</th>
        </tr>
        </thead>
        <tbody>
        <!-- Organisation data will be inserted here -->
        </tbody>
    </table>
</div>

<div id="Relationships" class="tabcontent">
    <h2>Relationships</h2>
    <p>This tab displays the various relationships</p>
    <button onclick="document.getElementById('import-relationships-input').click()">Import from CSV</button>
    <input type="file" id="import-relationships-input" onchange="importRelationships(this.files[0])"
           style="display: none;" accept=".csv">
    <button onclick="exportRelationships()">Export to CSV</button>
    <table id="relationships-table">
        <thead>
        <tr>
            <th>ID</th>
            <th>Created At</th>
            <th>Last Confirmed At</th>
            <th>Ended At</th>
            <th>Primary Party</th>
            <th>Related Parties</th>
            <th>Type</th>
        </tr>
        </thead>
        <tbody>
        <!-- Relationship data will be inserted here -->
        </tbody>
    </table>
</div>

<div id="Interactions" class="tabcontent">
    <h2>Interactions</h2>
    <div style="max-width: 1500px">

        <p>This tab displays interactions. The API to fetch interactions supports filtering on <code>profileId</code>,
            <code>contactId</code>, <code>createdAt</code>, and <code>interactionType</code>. The
            <code>interactionType</code> and <code>createdAt</code> query filters can be used together to fetch all
            "register interest" interaction since a particular date. The interaction details are stored in a JSON
            object. This allows new interaction types to be added without having to change the API or database schema.
        </p>
        <p>
            If the contact/person doesn't already exist in the system, it will be created automatically (minted) when
            importing.

            If the profile doesn't already exist, it will also be created automatically and linked to the
            contact/person.
            The profile type will depend on the type of interaction.
        </p>
        <p>
            Note that the <code>payload</code> field is a JSON object and may contain commas, which may interfere with
            CSV parsing. The import/export functions handle this by stringifying the JSON object when exporting and
            parsing it back when importing.
        </p>
    </div>
    <button onclick="document.getElementById('import-interactions-input').click()">Import from CSV</button>
    <input type="file" id="import-interactions-input" onchange="importInteractions(this.files[0])"
           style="display: none;" accept=".csv">
    <button onclick="exportInteractions()">Export to CSV</button>
    <table id="interactions-table">
        <thead>
        <tr>
            <th>ID</th>
            <th>Created At</th>
            <th>Contact ID</th>
            <th>Profile ID</th>
            <th>Interaction Type</th>
            <th>Payload</th>
        </tr>
        </thead>
        <tbody>
        <!-- Interaction data will be inserted here -->
        </tbody>
    </table>
</div>

<script src="js/demo.js"></script>
</body>
</html>
